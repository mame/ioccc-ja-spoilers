---
id: 1992/imc
year: 1992
order: 7
authors: "Ian_Collier"
orig_url: "https://www.ioccc.org/1992/imc.c"
hint_url: "https://github.com/ioccc-src/winner/blob/main/1992/imc.hint"
title: "IOCCC 1992: Best Output"
award_ja: "最高の出力"
---

## 動作

マンデルブロ集合。画像での表示とテキストでの表示がある。

画像での表示は、[Sun Raster](https://en.wikipedia.org/wiki/Sun_Raster)という、いにしえのフォーマットで出力される。
しかもx86だとヘッダがリトルエンディアンで出てしまうので、ビッグエンディアンに直す必要がある。
直したあとは、imagemagickを使えばpngなどに変換できる。
端的には、次のように実行すればよい。

```
$ gcc -m32 -o imc imc.c

$ ./imc | ruby -e 'print $<.read.unpack("N8C*").pack("V8C*")' > tmp.sun

$ convert tmp.sun tmp.png
```

{% include img.html src="1992-imc-1.png" desc="tmp.sun" %}

次のようにコマンドラインオプションをつけると、テキストで表示される。

```
$ ./imc -text

.** ************     ** * * *   **** *  *****                 **
.** ***********   ***   **       * ***** ****                 **
.* **********   ****     *         *  ** *****                 *
.* ********* ******    *                * ****                 *
.********  **  **   **                  * *****                *
.*****    * * ** ***                   ** *****                *
. **     ** ** * ***                   **  *****
.**     *****     **                   **  *****
.*     ******      *                  * *  *****
.     *  *  *       *                 * *  *****
. * ** ****                             *  *****
.                                     * *  *****
. * ** ****                             *  *****
.     *  *  *       *                 * *  *****
.*     ******      *                  * *  *****
.**     *****     **                   **  *****
. **     ** ** * ***                   **  *****
.*****    * * ** ***                   ** *****                *
.********  **  **   **                  * *****                *
.* ********* ******    *                * ****                 *
.* **********   ****     *         *  ** *****                 *
.** ***********   ***   **       * ***** ****                 **
.** ************     ** * * *   **** *  *****                 **
```

## 解説

プログラム側でエンディアンを直したければ、プログラムの中頃にある`0x59A66A95,256,192,1,6912,1,0,0`というヘッダデータのエンディアンを反転させて次のようにすれば修正できると思う。
しかし長くなってしまい、意匠が壊れるのでパッチは避けた。

```
h[]={2506794585,65536,3221225472,16777216,1769472,16777216,0,0}
```

コマンドラインオプションが結構充実していて、描画位置やサイズを変更できたり、ジュリア集合もかけたりする。
詳しくはimc.hint参照。

hintの中でおすすめされているコマンドの出力は次の通り。

{: .wrap }
```
$ ./imc -s 512,512 -f 600000 -l 512 -m 16 -c.00805,.74274 | ruby -e 'print $<.read.unpack("N8C*").pack("V8C*")' > tmp2.sun

$ convert tmp2.sun tmp2.png
```

{% include img.html src="1992-imc-2.png" desc="tmp2.sun" %}

{: .wrap }
```
$ ./imc -s512,512 -j-.523,-.535 | ruby -e 'print $<.read.unpack("N8C*").pack("V8C*")' > tmp3.sun

$ convert tmp3.sun tmp3.png
```

{% include img.html src="1992-imc-3.png" desc="tmp3.sun" %}

ここまでマンデルブロ集合がなかったのはちょっと意外。
発見が1978年で流行が1980年代中頃らしい。
