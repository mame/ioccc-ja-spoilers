#include &lt;math.h&gt;
#define e(a, d) for(a=0;a&lt;d;a++)
char*x=&quot;	{&#x000c;k&#x000b;/;	y{ &#x0013;&#x000b;q &#x001a;; &#x001a;}	c &#x0012;{	@;	={ &#x0002;	S}	c}	W;&#x000b;;	&#x0011;{&#x000b;4}	k |;&#x000c;&#x000b; w{	+&#x000c;9;&#x000c;{;	8; 9{	S;	/}	y{ K}	&#x007f;{&#x000b;;}	l&#x000c;&#x0016;{	&#x0015;{ ~{ &#x0016;;	V}&#x000b;k}&#x000b;g&#x000c;&lt; t{	E	v;&#x000c;M{ &#x0017;&#x000c;B}&#x000b;y}	&lt;{&#x000c;7;&#x000c;/;&#x000b;&#x000e;	Y} t&#x000b;&#x0014;}&#x000c;k&#x000b;p; Y} $&#x000b;H&#x000b;&#x001c;&#x000b;a{&#x000c;e} &#x0005;&#x000c;w}&#x000b;;} R}&#x000b;&#x000c; /{&#x000b;&gt;}&#x000c;a	&#x000b;;&#x000b;&#x0010;} &#x0005;;	`	$&#x000b;W&#x000b;-}	D}&#x000b;B; &#x0003;&#x000c;e;&#x000b;f;&#x000c;*;	~;&#x000c;A;&#x000b;s O{	o;&#x000b;&gt;{&#x000c;1; m{ `} R}&#x000c;]{ T} v}&#x000c;={ I&#x000c;&#x0005;} ; &#x000e;}&#x000b;a&#x000b;?&#x000b;&amp;; A}&#x000b;$;&#x000b;W;&#x000c;R{&#x000c;u} `; j}&#x000b;W;&#x000b;s{&#x000c;e}	A;&#x000b;[	R;	&#x0010;&#x000b;X &#x0018; P; 4&#x000c;&#x000b; ,&#x000b;F;&#x000b;({&#x000c;&lt;&#x000c;8{&#x000c;#;&#x000b;%}&#x000b;@&#x000c;J{&#x000b;)}	&#x0019;}&#x000b;o&#x000b;^&#x000b;*{&#x000c;u&#x000c;/{&#x000c;&#39;}&#x000b;]{	*&#x000c;&#x0002;}	&#x0001;}	&#x0010;;&#x000b;&#x0003;{ r}	f	/;&#x000c;&#x0007;}&#x000c;e} &#x007f;}&#x000b;w{ ${&#x000b;&#x0013;{&#x000b;&#x001d;;&#x000b;,; @ d	$}&#x000b;];&#x000c;&gt;&#x000b;(}	I{ d}	&amp;;	U}	&#x0018;{	y;&#x000c;Y}	&#x000c;{ P{	R} T}&#x000c;_{ &#x0016;}&#x000b;R &#x0008;} l	&#x000f;{ T}&#x000b;&quot;
&quot;&#39;;	|&#x000b;&#x0002;; ${&#x000c;=}	H} (}&#x000b;&#x0013;}&#x000c;8{&#x000b;c&#x000b;p{ s} #}&#x000b;+}	3}&#x000b;k&#x000c;F}&#x000c;&lt;&#x000b;H&#x000c;	 .{ &#x0018;}&#x000b;G}&#x000c;x;	r	D&#x000b;&#x0005; c{&#x000c;&#x0019;; W; &#x000b;{	b;&#x000b;6; k{&#x000b;&#x000b;}&#x000b;B;&#x000b;*}&#x000c;&#x001b;;	]} ~	&#x000f;{&#x000c; ;&#x000b;;} !}&#x000b;&#x000e;}	x}&#x000b;v}&#x000b;n;&#x000c;^;	6&#x000c;V}&#x000b;Y{ h; ~	%&#x000b;*}&#x000c;! H; G{ r{ f;&#x000b;Y{ i}&#x000b;z} N &#x0011; %}&#x000c;.{&#x000c;&#x0017;;	( &#x0016;	v} _}	h; 7;&#x000c;&lt;}	^;&#x000b;Z;&#x000b;0; &#x0019;;	&lt;;&#x000b;&lt;; M; N{&#x000b;	}	&#x0005;&#x000b;_{&#x000b;O} !{&#x000c;f{&#x000c;]{&#x000b;M{&#x000b;&#x0018;;&#x000c;A{&#x000c;&#x0006;}	0;&#x000b;S}&#x000b;${	@;&#x000b;x}&#x000b;y}&#x000c;@	L;&#x000c;1	t{ 3{&#x000b;c{&#x000c;s{&#x000b;_{	`{	D{ ]}&#x000b;!;	${	_&#x000c;J;&#x000c;v&#x000c;+ &#x0003;}	3{&#x000b;B;&#x000b;&#x0018; ]{	&#x0014;}	E&#x000b;6	.&#x000c;x{&#x000c;?&#x000c;+; &#x001a;{&#x000b;x; &#x007f;}&#x000c;v{&#x000c;$}&#x000c;&#x001a;;&#x000b;6}&#x000b;T; O; &#x0011;; (}&#x000c;X&#x000b;7}	j; @} :}&#x000b;#	c{ !{ &#x001c;}&#x000c;x	K&#x000c;X&#x000b;t} &gt;; ?{ c; &#x0005;;	W;	&#x007f;; l;&#x000c;&#x0007;} h}&#x000c;p}	i{ %	&#x000e;}&#x000c;P}	/{	*}&#x000c;&#x0004;	%&#x000c;L; &#x0007;;	!{&#x000b;&#x000f; S{ n&#x000b;&#x000f;} &#x0011;&#x000c;&quot;
&quot;&#x0014;&#x000c;x; &#x0002; &#x007f;{ 1&#x000c;&#x001f;	J;&#x000b;v{	U}&#x000c;({	@ X{ k} H;&#x000c;4;&#x000b;e J	6;&#x000c;&#x0015;;&#x000b;v; G{&#x000b;&#x0004;{&#x000b;]	&amp;{&#x000c;A d{ l&#x000b;M{&#x000b;&#x0016;;&#x000b;K&#x000b;;;	4&#x000b;-{&#x000c;}} p h{&#x000c;&#x000e;;	&#x001a;{	r&#x000b;W;	v{&#x000b;&#x001f;;	f}	&#x001f;}&#x000c;1{&#x000b;^&#x000c;&amp;{&#x000b;9{&#x000b;&#x0017;{ &#x0015;;&#x000c;~;&#x000b;n;&#x000b;q{	9 &#x001c;&#x000b;R	6{	{ u;&#x000b;a;	&#x001f;;	U;	&#x001a;;&#x000c;Y}	+}&#x000c;&#x0003;}&#x000b;2&#x000c;s&#x000b;k; 8	&#x0011;{	J&#x000c;K;&#x000b;&#39;&#x000c;i;&#x000b;	;&#x000b;$;	W{	P&#x000b;!{&#x000c;&#x0007;{&#x000b;&#x0005;{&#x000b;P	&#x001d;} [;	(;&#x000b;Q; U&#x000c;n;&#x000b;+}&#x000b;&#x000e;&#x000b;g{&#x000c;C;&#x000b;&#x0001;{&#x000c;&#x001c;{	&#x001c;; &lt;{	v&#x000b;&#x000e;&#x000b;S} b;&#x000c;6&#x000c;`&#x000b;&#x001f;} ?{&#x000c;+	%;	&#x000f;}&#x000c;n;&#x000b;q{ r}&#x000b;k; &#x000c;;&#x000c;&#x000b;{&#x000b;c{ S} 2}&#x000b;~{	4;&#x000b;R&#x000c;W v} &#x000f;&#x000c;R;	k&#x000c;I}&#x000b;|; &#x0001;&#x000c;d; [ O}&#x000c;5; &#x0017;;&#x000b;&#x001b;;&#x000c;&#x0010;}&#x000b;Z d	&#x001e;{ &#x0004;&#x000b;&#x0003;{&#x000c;&amp;;&#x000c;h	o{ V	v &#x0003;;	_{&#x000c;&#x0011;{&#x000b;/} &#x000b; F{&#x000c;f{&#x000c;r{&#x000b;4{&#x000b;&#x0010;{&#x000c;?{ 4;&#x000c;S}	:;&#x000c;]&#x000b;&#x001e;;&#x000b;E}	&#x0002;;	&amp;} #&#x000b;e !{&#x000c;&gt;{&#x000b;H; &#x0015;{&#x000c;O{ 0;&#x000b;&#x007f;} H;	p&#x000b;&#x001e;; w}&#x000c;&#x0001;&#x000b;&gt;{&#x000c;1}&#x000c;&#x000e;{	-} 4&#x000c;&#x0013;;&#x000c;&quot;
&quot;S}&#x000c;&#x0016;}	u L{ y} %;&#x000c;2 &#x0018; |{&#x000c;(}	/;&#x000b;,{&#x000b;&#x0018; )}&#x000c;Y;&#x000b;g}	G}&#x000c;v;&#x000c;T}	};&#x000b;&#x0013;}&#x000c;i {{ &quot;{{&quot; }}&#x000b;};&#x000b;[{ E{&#x000b;q} g;&#x000b;T{ ={&#x000c;&#x007f;}&#x000b;R;	k{ j;&#x000c;_;&#x000b;h}&#x000c;g&#x000b;P&#x000b;c;&#x000b;({	F;&#x000c;6}	}} 3	,}&#x000c;&lt;; 0	&#x0019; P;&#x000b;&#x000f;{&#x000c;&#39;&#x000c;t}&#x000c;u}&#x000c;&#x0011;;		}&#x000b;U}&#x000b;s{&#x000c;8{ E}&#x000b;&#x000e; &gt;{&#x000c;&#x0019;}&#x000c;E	&#x0010;{&#x000b;G&#x000b;&#x001e;{&#x000b;H :{ &#x0004; Y&#x000b;o&#x000c;g}	&#x0015;}&#x000c;F  &#x000c;D{ R{	 &#x000b;-;&#x000b;M&#x000c;?;&#x000c;= q}&#x000c;_ U	&#x001d;{&#x000b; ;	&#x0002; I&#x000b;&#x001f;	&#x0017;{ |{&#x000c;&#x000b;{&#x000b;&#x001e;}	&#x0016; &#x000f;	1{&#x000b;,}&#x000c;&#x0012;{ x{&#x000b;&#x000e;{ U{ s;&#x000b;J}&#x000c;&#x001f;}&#x000c;&#x0001;	6{&#x000c;&gt;&#x000c;7&#x000b;;&#x000b;,{ D{	{{ &quot;{{&quot; }} &#x001e;;&#x000b;]}	&#x0011;;&#x000b;M; &amp;}&#x000c;&#x0017;{ V}	&#x001a;&#x000b;n{&#x000c;&amp;	T&#x000b;~;&#x000c;({	&#x0007;}&#x000c;[;	r{&#x000c;#	u{&#x000b;X 9;&#x000c;L; U&#x000c;f}&#x000c;)} &#x0013;  {&#x000c;T}	&#x000e;	p{	N;	&gt;{	&gt;	&#x0001;}&#x000b;&#x0012;&#x000b;&#x0003;}&#x000c;D} m&#x000b;&#x0006;{&#x000b;1{	&#x0016;{&#x000b;&#x001d;}&#x000c;X&#x000c;&#x007f;; o}	w}&#x000b;$}	^&#x000c;v} K &#x007f; f	,}	^&#x000b;3; &#x001f;{ @{&#x000c;_} _{	o;	4}	h}&#x000b;H;&#x000b;#&#x000c;.{	{}	&#x0018;;	&lt;{ &#x0016;{&#x000c;G{ $;&#x000c;&#x0008;{ &quot;
&quot;z &#x0006;{&#x000b;a{&#x000c;&#x0011;{&#x000b;D;	?&#x000b;|}&#x000b;&#x001c;{&#x000b;&#x0007;{ &#x0012;;	`}&#x000c;&#x001c; &#x001c;}	Q}&#x000b;j;&#x000c;4} &#x001e;	3{&#x000c;Q}	&#x0018;{	* &#x000f;;&#x000c;&#x000e;}&#x000b;r{&#x000c;a}	&#x0007;} &#x000c;&#x000b;R&#x000b;&#x0012;{&#x000c;p @; &#x0002; N{ &#x0018;{&#x000c;f; A;&#x000c;8}&#x000b;L	$}&#x000c;&#x0017;{ }&#x000c;&#x0008;}&#x000b;J{ &#x0011;}	k{&#x000b;r}&#x000c;&#x0016; &#x007f;{ [; -;&#x000b;p{	I{ &#x0008;&#x000c;&#x000b;{	&amp;}&#x000b;J;	T}	?{&#x000c;Z{&#x000c;&gt;;	5&#x000b;&gt;; ]; &#x0003; w&#x000b;z ^}	u;&#x000c;);	H}&#x000b;	; L	&amp;;	V	E{&#x000c;1{&#x000b;g;&#x000b;C}&#x000b;&#x0017; V} ~;&#x000c;U; ^{	J; &#x001c;{ /}	{;&#x000c;(}&#x000c;y} a&#x000c;K&#x000c;&#x000f; /}	.}&#x000c;&#x001a;;&#x000c;K;&#x000c;N{&#x000c;w{ `{	&#x001c;}&#x000b;&#x001b;&#x000c;T{&#x000b;l&#x000b;`; #;&#x000b;N{&#x000b;l&#x000c;X;	?; &#x000c;&#x000b;+}&#x000c;&#x001e;{ &#x0016;	w{	&#x000b;;	q;	z;&#x000b;_;&#x000c;y} 8} &#x0006;	&amp;{&#x000b;X}	V{ W&#x000c;G}	&#x001a;&#x000c;,; [}&#x000c;U{	v{	Q;	w{&#x000c;&#x0003;	[&#x000c;&#x007f;	Y}&#x000b;N	Y&#x000c;u i{ {&#x000b;!&#x000c;A{&#x000c;}{ b&#x000b;0;	X&#x000b;~} &#x000b;;&#x000b;-; 8{	E&#x000b;&#x0007; &#x000f;}	&#x0014;;&#x000b;F{	y&#x000c;{}&#x000b;&#x0004;{	&#x000f;&#x000b;&quot;;
int y[3][1&lt;&lt;20],i[2048],X[166],p,r=1,f,s,O,P;
Q(){
int b;
r*=s;
p*=s;
if(s&gt;&gt;9){
if(b=*x){
p+=b-1-(b&gt;10)-(b&gt;13)-(b&gt;34)-(b&gt;92)&lt;&lt;4;
b=x[1];
x+=2;
p+=b&lt;33?(b^8)*2%5:(b^6)%3*4+(*x++^8)*2%5+4;
}
}
else{
b=getchar();
p+=b&lt;0?0:b;
}
}
t(E){
int u,k,F,*m;
if(r&lt;s)Q();
m=X+E*2;
F=*m+m[1]+2;
u=r*(*m+1)/F;
if(k=p&gt;=u){
p-=u;
r-=u;
}
else r=u;
m[k]++;
if(F&gt;63){
*m/=2;
m[1]/=2;
}
return k;
}
n(E){
int a,b;
a=0;
while(!t(E+a))a++;
b=1;
while(a--)b=b&lt;&lt;1|t(4);
return b-1;
}
R(S,Y,T,Z,U,d,V)int*S,*T;
{
int G,a,j,H;
e(H,d)e(a,d){
G=0;
e(j,d)G+=T[j*Z+H*U]*lrint(cos(acos(-1)/d*(a+0.5)*j)*sqrt(2-!j)*1024);
S[a*Y+H*U]=G+(1&lt;&lt;V-1)&gt;&gt;V;
}
}
W(z,l,g){
int v,a,j,I,d,k,A,*o,c,B,q,C,h,w,J;
if(g&gt;5||g&gt;2&amp;&amp;t(g-3)){
c=1&lt;&lt;--g;
e(a,4)W(z+a%2*c,l+a/2*c,g);
}
else{
c=1&lt;&lt;g;
d=c*c;
q=n(73);
e(A,3){
o=y[A]+l*f+z;
B=A&gt;0;
e(a,d)i[a]=0;
e(a,d){
if(t(61+g*2+B))break;
a+=n(5+B*10);
k=1-2*t(3);
i[a]=k*(n(25+(B+(a&lt;d/8)*2)*10)+1)*(A?P:O);
}
if(!q){
v=0;
e(a,c){
v+=l?o[-f+a]:0;
v+=z?o[a*f-1]:0;
}
*i+=z&amp;&amp;l?v/2:v;
}
R(i+d,1,i,1,c,c,10);
R(o,f,i+d,c,1,c,10+g);
if(q){
C=q&lt;17;
w=C?9-q:q-25;
e(a,c)e(j,c){
e(I,2){
h=a*w+w;
J=h&amp;7;
h=(h&gt;&gt;3)+j+I;
if(k=h&lt;0)h=(h*8+w/2)/w-2;
h=h&lt;c?h:c-1;
i[I]=k^C?o[h*f-1]:o[-f+h];
}
o[C?j*f+a:a*f+j]+=*i*(8-J)+i[1]*J+4&gt;&gt;3;
}
}
}
}
}
K(b){
putchar(b&lt;0?0:b&gt;255?255:b);
}
main(D){
int a,l,L,M,g,N;
s=D&gt;1?256:1968;
Q();
g=n(5);
f=1&lt;&lt;g;
N=f-n(5);
O=n(5);
P=n(5);
W(0,0,g);
printf(&quot;P6 %d %d 255 &quot;,f,N);
e(a,N*f){
l=y[0][a];
L=y[1][a];
M=y[2][a];
D=l-L;
K(D+M);
K(l+L);
K(D-M);
}
return 0;
}
