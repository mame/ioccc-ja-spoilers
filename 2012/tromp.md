---
id: 2012/tromp
year: 2012
order: 10
authors: "John_Tromp"
orig_url: "https://www.ioccc.org/2012/tromp/tromp.c"
hint_url: "https://www.ioccc.org/2012/tromp/hint.html"
title: "IOCCC 2012: Most functional"
award_ja: "もっとも関数的"
---

## 動作

[バイナリラムダ計算](https://esolangs.org/wiki/Binary_lambda_calculus)のインタプリタ。

ヒルベルト曲線を描くプログラムを実行する例。

```
$ gcc -m32 -DInt=int -DX=4 -DA=500000 -o tromp tromp.c

$ ( cat hilbert.Blc; echo -n 1234 ) | ./tromp
 _   _   _   _   _   _   _   _
| |_| | | |_| | | |_| | | |_| |
|_   _| |_   _| |_   _| |_   _|
 _| |_____| |_   _| |_____| |_
|  ___   ___  | |  ___   ___  |
|_|  _| |_  |_| |_|  _| |_  |_|
 _  |_   _|  _   _  |_   _|  _
| |___| |___| |_| |___| |___| |
|_   ___   ___   ___   ___   _|
 _| |_  |_|  _| |_  |_|  _| |_
|  _  |  _  |_   _|  _  |  _  |
|_| |_| | |___| |___| | |_| |_|
 _   _  |  ___   ___  |  _   _
| |_| | |_|  _| |_  |_| | |_| |
|_   _|  _  |_   _|  _  |_   _|
 _| |___| |___| |___| |___| |_
```

素数列挙。素数番目のビットが1になっている。

```
$ cat primes.blc | ./tromp -b
001101010001010001010001000001010000010001010001000001000001010000010001010000010001000001000000010001010001010001000...
```

## 解説

バイナリラムダ計算は、作者自身が開発した[ラムダ計算](https://ja.wikipedia.org/wiki/%E3%83%A9%E3%83%A0%E3%83%80%E8%A8%88%E7%AE%97)のバイナリ表現方法。

* ラムダ抽象は `00 <term>`
* 関数適用は `01 <term> <term>`
* 変数参照は`1 1* 0`（中の1の数は[de Bruijnインデックス](https://ja.wikipedia.org/wiki/%E3%83%89%E3%83%BB%E3%83%96%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%BB%E3%82%A4%E3%83%B3%E3%83%87%E3%83%83%E3%82%AF%E3%82%B9)）

拡張子が.Blcなファイルはバイナリ表現のソースコードで、.blcはテキスト表現（`0`と`1`の列）。
テキスト表現のソースコードを実行するときは"-b"というコマンドライン引数を与える。

入力のバイト列は、長さ8のブーリアンのリストのリスト（[チャーチエンコーディング](https://en.wikipedia.org/wiki/Church_encoding)によって表現されている）によって渡される。
同じフォーマットのデータを評価結果とすることで、出力もできる。

入力をそのまま出力するプログラムは、引数をそのまま返す恒等関数（`\x x`）なので、`0010`とエンコードされる。
4ビットなので、「ハーフバイト」と主張している。
hint.textには、自分自身のインタプリタ、素数のふるい、ヒルベルト曲線、BrainFuckインタプリタなどのサンプルコードが掲載されている。

実装詳細は見ていないが、問いかけがあるので興味のある人は見てほしい。
how13ファイルに、大まかなデータ構造と各変数および関数の目的が書かれているので、解析するときは参考になる。
